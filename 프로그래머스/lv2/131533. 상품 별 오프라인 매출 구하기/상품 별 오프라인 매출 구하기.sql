SELECT P.PRODUCT_CODE, SUM(SALES_AMOUNT) * P.PRICE AS 'SALES'
FROM PRODUCT AS P
JOIN OFFLINE_SALE AS O
USING (PRODUCT_ID)
GROUP BY 1
ORDER BY 2 DESC, 1;